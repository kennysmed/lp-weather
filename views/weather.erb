<!DOCTYPE html>
<html>
<head>
  <title>Weather</title>
  <style type="text/css" media="screen">
	body {
		font-family: Arial;
		text-transform: uppercase;
		font-size: 22px;
		line-height: 27Â§px;
		margin: 0;
		width: 384px;
		padding: 0;
	}
	p {
		margin: 0;
		padding: 0;
	}

	.weather {
		width: 384px;
		margin-top: 10px;
		margin-bottom: 20px;
	}
		.weather-icon {
			display: inline-block;
			width: 100px;
			margin-right: 5px;
			vertical-align: top;
			margin-top: 3px;
		}
		.weather-forecast {
			display: inline-block;
			word-wrap: break-word;
			width: 272px;
			vertical-align: top;
		}
	span.dot {
		font-size: 16px;
	}
	span.heavy {
		font-weight:900;
	}
	.address {
		word-wrap: break-word;
		font-size: 17px;
		line-height: 19px;
		text-align: center;
	}
  </style>
</head>
<body>
<img src="/images/dotted_line_title.png"/>

<div class="weather">
	<img class="weather-icon" src="/images/<%= @forecast[:weather_image]%>.png"/>
	<p class="weather-forecast">
		<span class="heavy"><%= @forecast[:weather_description]%></span><br />
		MIN: <%= @forecast[:min].to_f.round() %>&#176;<%= @forecast[:units] %> &#8226; MAX: <%= @forecast[:max].to_f.round() %>&#176;<%= @forecast[:units] %> 
		<% if @forecast[:precip_probability] > 0 %>
			<br />
			<%= (@forecast[:precip_probability] * 100).round() %>% chance of&nbsp;<%= @forecast[:precip_type] %>
		<% end %>
	</p>
</div>

<p class="address">
	<% if @forecast[:address] != '' %>
		<%#
		If the address is very long, we trim to the first two clauses, so 
		"Kennington, London Borough of Lambeth, London SE11, UK"
		becomes
		"Kennington, London Borough of Lambeth"

		Also, we replace the final space with &nbsp; to prevent widows.
		%>
		<%= @forecast[:address][/([^,]+,?(?:[^,]*))/].gsub(/(.*)( )(.*)/, '\1&nbsp;\3') %>
	<% end %>
</p>

<img src="/images/dotted_line.png"/>
</body>
</html>
